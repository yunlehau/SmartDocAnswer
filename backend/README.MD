# ğŸ“ RAG File CMS API with OpenAI Chat

A modular FastAPI-based Content Management System that enables file upload, versioning, preview, semantic search (ChromaDB), and OpenAI-powered document Q&A chat.

---

## ğŸš€ Features

- Upload files (PDF, TXT, etc.) with metadata
- File versioning support
- File preview and download
- Persistent local storage using JSON (no database required)
- OpenAI GPT-4.1 integration for document-based Q&A
- Semantic search with ChromaDB + SentenceTransformer
- Modular FastAPI backend with best practices
- Swagger UI at `/docs`
- CORS enabled for frontend access

---

## ğŸ“¦ Project Structure

```
backend/
â”œâ”€â”€ main.py                     # FastAPI app entry point
â”œâ”€â”€ models/
â”‚   â””â”€â”€ document.py             # Document and Version models
â”œâ”€â”€ routes/
â”‚   â”œâ”€â”€ files.py                # File upload, list, preview, delete
â”‚   â””â”€â”€ chat.py                 # Chat endpoint using OpenAI + ChromaDB
â”œâ”€â”€ services/
â”‚   â”œâ”€â”€ file_service.py         # File saving, hashing, DB load/save, auto vector index
â”‚   â”œâ”€â”€ chat_service.py         # OpenAI integration + context retrieval
â”‚   â””â”€â”€ vector_db_service.py    # ChromaDB + SentenceTransformer for semantic search
â”‚   â””â”€â”€ image_to_text.py        # OCR for image files
â”‚   â””â”€â”€ text_to_speech.py       # TTS for chat response
â”œâ”€â”€ uploaded_files/             # Where user files are stored
â”œâ”€â”€ cms_data.json               # Metadata persistence
â”œâ”€â”€ chroma_data/                # ChromaDB persistent vector storage
```

---

## ğŸ§ª Local Setup

### 1. Create Virtual Environment
```powershell
python -m venv venv
venv\Scripts\activate
```

### 2. Install Dependencies
```powershell
pip install fastapi uvicorn python-multipart PyPDF2 openai chromadb sentence-transformers Pillow torch tensorflow pytesseract scipy langdetect
```

### 3. Run the Server
```powershell
uvicorn main:app --reload
```

### 4. Visit Swagger Docs
[http://localhost:8000/docs](http://localhost:8000/docs)

---

## ğŸ“‚ API Endpoints

### ğŸ“ File Management

| Method | Endpoint                          | Description                            |
|--------|-----------------------------------|----------------------------------------|
| POST   | `/api/files/upload`               | Upload a new file with metadata        |
| GET    | `/api/files`                      | List all uploaded documents            |
| GET    | `/api/files/{doc_id}`             | Get metadata for a specific document   |
| GET    | `/api/files/{doc_id}/preview`     | Download/preview a document            |
| GET    | `/api/files/{doc_id}/versions`    | View version history                   |
| DELETE | `/api/files/{doc_id}`             | Delete a document and its versions     |

---

### ğŸ’¬ Chat (OpenAI + ChromaDB-powered)

| Method | Endpoint     | Description                                 |
|--------|--------------|---------------------------------------------|
| POST   | `/api/chat`  | Ask a question based on uploaded document (semantic search via ChromaDB) |
| GET    | `/api/health`| Health check                                |

### ğŸ”§ Example Usage (Chat)

```powershell
curl -X POST http://localhost:8000/api/chat ^
  -F context_file=@example.pdf ^
  -F message="What is the purpose of this document?"
```

---

## ğŸ” Environment Variables

| Key              | Description                        |
|------------------|------------------------------------|
| `OPENAI_API_KEY` | Your OpenAI API key                |
| `OPENAI_ENDPOINT`| Custom endpoint (if using a proxy) |

---

## ğŸ§± Future Enhancements

- Dockerfile + Docker Compose support
- Role-based authentication & admin UI
- Vector DB integration (ChromaDB, Qdrant / Pinecone)
- Streaming answer support via SSE
- React frontend integration

---

## ğŸ‘¨â€ğŸ’» Author

Built with â¤ï¸ using FastAPI + OpenAI + ChromaDB. Ready for enterprise-scale document Q&A.

